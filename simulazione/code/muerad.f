      subroutine muerad(Qmu,p1,p2,p3,p4,k,cm2,ce2,cem)
** summed over spin/elicities. it's much faster (~0.35)      
      implicit double precision (Z)
      double precision cm2,ce2,cem,somma,Qmu
      double precision p1(0:3),p2(0:3),p3(0:3),p4(0:3),k(0:3)
      double precision t13m1,t24m1,dp1km1,dp2km1,dp3km1,dp4km1
      double precision dp1km2,dp2km2,dp3km2,dp4km2
      double precision t13m2,t24m2
      double precision p1k,p2k,p3k,p4k
      double precision p1p22,p1p32,p1p42,p2p32,p2p42,p3p42
      common/ifirstradsum/ifirst
      integer ifirst
      data ifirst /0/
      double precision mm,mm2,me,me2,mm4,me4
      common/masses/mm,mm2,me,me2,mm4,me4

      double precision dot
      external dot
      
      if (ifirst.eq.0) then
         me = 0.510998928D-3
         mm = 105.6583715D-3
         me2 = me*me
         me4 = me2*me2
         mm2 = mm*mm
         mm4 = mm2*mm2
         ifirst = 1
      endif
      
      t13m1 = 1.d0/dot(p1-p3,p1-p3)
      t24m1 = 1.d0/dot(p2-p4,p2-p4)
      
      t13m2 = t13m1*t13m1
      t24m2 = t24m1*t24m1

      p1p2 = dot(p1,p2)
      p1p3 = dot(p1,p3)
      p1p4 = dot(p1,p4)
      p2p3 = dot(p2,p3)
      p2p4 = dot(p2,p4)
      p3p4 = dot(p3,p4)
      
      p1k = dot(p1,k)
      p2k = dot(p2,k)
      p3k = dot(p3,k)
      p4k = dot(p4,k)
      
      dp1km1 = 0.5d0/p1k
      dp2km1 = 0.5d0/p2k
      dp3km1 = 0.5d0/p3k
      dp4km1 = 0.5d0/p4k

      dp1km2 = dp1km1*dp1km1
      dp2km2 = dp2km1*dp2km1
      dp3km2 = dp3km1*dp3km1
      dp4km2 = dp4km1*dp4km1
      
      p1p22 = p1p2*p1p2
      p1p32 = p1p3*p1p3
      p1p42 = p1p4*p1p4
      p2p32 = p2p3*p2p3
      p2p42 = p2p4*p2p4
      p3p42 = p3p4*p3p4
      
      if (Qmu.lt.0.d0) then
         Z1_=p1p4 - p4k
         Z1_=Z1_*p2p3
         Z2_=p2k*p3p4
         Z3_=p1p2*p3p4
         Z4_= - Z1_ + Z2_ - Z3_
         Z4_=Z4_*mm2*dp1km2
         Z5_=p3p4 + p4k
         Z5_=Z5_*p1p2
         Z6_=p2k*p1p4
         Z5_=Z5_ + Z6_
         Z7_=p2p3*p1p4
         Z8_= - Z7_ - Z5_
         Z8_=mm2*Z8_
         Z9_=p1p3*mm2
         Z9_= - Z9_ + 2*mm4
         Z10_=mm2*p1k
         Z10_=Z10_ - Z9_
         Z10_=me2*Z10_
         Z11_=p2p4*mm4
         Z8_=Z10_ + Z11_ + Z8_
         Z8_=dp3km2*Z8_
         Z10_= - mm2*p3k
         Z9_=Z10_ - Z9_
         Z9_=me2*Z9_
         Z9_=Z9_ + Z11_
         Z9_=dp1km2*Z9_
         Z4_=Z8_ + Z4_ + Z9_
         Z8_=2*p1p4
         Z9_= - p3p4 - Z8_
         Z9_=p1p2*Z9_
         Z10_=2*p1p3
         Z11_=Z10_ + mm2
         Z12_= - p3k + Z11_
         Z12_=me2*Z12_
         Z1_=Z12_ - Z1_ + Z2_ + Z9_
         Z1_=dp1km1*Z1_
         Z2_=2*p3p4
         Z9_=Z2_ + p4k
         Z9_=Z9_*p1p2
         Z12_=2*mm2
         Z13_=Z12_*p2p4
         Z9_=Z9_ - Z13_
         Z14_=Z8_ - p4k
         Z14_=Z14_*p2p3
         Z15_= - p3p4 + p1p4
         Z15_=p2k*Z15_
         Z15_=Z14_ + Z15_ + Z9_
         Z15_=p1p3*Z15_
         Z16_=2*me2
         Z17_=p1p3*Z12_
         Z17_= - p1p32 + Z17_
         Z17_=Z17_*Z16_
         Z18_= - p2k*p4k*Z12_
         Z15_=Z17_ + Z18_ + Z15_
         Z15_=dp1km1*Z15_
         Z17_=Z2_ + p1p4
         Z17_=p2p3*Z17_
         Z11_= - p1k - Z11_
         Z11_=me2*Z11_
         Z5_=2*Z15_ + Z11_ + Z17_ + Z5_
         Z5_=dp3km1*Z5_
         Z1_=Z5_ + 2*Z4_ + Z1_
         Z1_=64*Z1_
         Z4_=p3p4*p1k
         Z5_=p1p2 - p1p4
         Z11_=p3k*Z5_
         Z15_=p1k + Z8_
         Z15_=p2p3*Z15_
         Z11_=Z15_ + Z11_ - Z4_ + 2*Z3_
         Z11_=p2p4*Z11_
         Z15_= - p2p42*Z12_
         Z11_=Z15_ + Z11_
         Z15_=2*dp4km1
         Z11_=Z11_*Z15_
         Z17_=mm2*p4k
         Z18_=Z17_ - Z4_
         Z19_=p3k*p1p4
         Z20_=Z3_ + Z18_ - Z19_
         Z21_= - p3k*p1k
         Z22_= - p1p3*p2p4
         Z21_=Z22_ + Z21_ + Z13_
         Z21_=dp4km1*Z21_
         Z21_=mm2 + 4*Z21_
         Z21_=me2*Z21_
         Z22_=2*p1p2
         Z23_= - p1p4 - Z22_
         Z23_=p2p3*Z23_
         Z11_=Z21_ + Z11_ + Z23_ + Z13_ - Z20_
         Z11_=dp2km1*Z11_
         Z21_=p1p4 + p1k
         Z21_=Z21_*p2p3
         Z23_=p3k*p1p2
         Z21_=Z21_ + Z23_ + Z3_
         Z24_=mm2*p2k
         Z25_=Z13_ + Z24_
         Z26_=Z8_*p3p4
         Z27_=Z26_ - Z25_ + Z21_
         Z27_=dp4km1*Z27_
         Z28_=p2p4*mm2
         Z21_=Z28_ + Z24_ - Z21_
         Z21_=dp4km2*Z21_
         Z24_= - dp4km1*mm2
         Z21_=2*Z21_ + Z24_
         Z21_=me2*Z21_
         Z20_= - Z7_ + Z28_ - Z20_
         Z16_=dp2km2*Z20_*Z16_
         Z20_= - dp4km2 - dp2km2
         Z12_=Z12_ - p1p3
         Z12_=me4*Z12_*Z20_
         Z11_=Z11_ + 2*Z12_ + Z16_ + Z27_ + Z21_
         Z11_=64*Z11_
         Z12_=p3p4*Z25_
         Z16_= - Z4_ - Z26_
         Z16_=p2p3*Z16_
         Z6_=Z6_*p3p4
         Z20_= - p3p42*Z22_
         Z12_=Z16_ + Z20_ - Z6_ + Z12_
         Z12_=Z12_*Z15_
         Z16_=4*mm2
         Z10_=Z16_ - Z10_
         Z20_= - p1k + Z10_
         Z20_=me2*Z20_
         Z9_=Z20_ + Z18_ + Z9_
         Z9_=p2p3*Z9_
         Z18_=p2p32*Z8_
         Z9_=Z18_ + Z9_
         Z9_=dp2km1*Z9_
         Z18_= - p3p4*Z16_
         Z2_=p1p3*Z2_
         Z2_=Z2_ + Z4_ + Z18_
         Z4_=Z15_*me2
         Z2_=Z2_*Z4_
         Z18_=p1p2 + p1p4
         Z20_= - Z18_ - p2k + p3p4 - p4k
         Z20_=Z20_*mm2
         Z21_=p1p3*p3p4
         Z22_=p1p3 + p1p4 - mm2
         Z22_=p2p3*Z22_
         Z2_=2*Z9_ + Z2_ + Z12_ + Z22_ + Z21_ - Z3_ - Z20_
         Z2_=dp3km1*Z2_
         Z9_= - p1p4*Z25_
         Z12_=Z3_*Z8_
         Z21_=Z23_*p1p4
         Z22_=p2p3*p1p42
         Z6_=2*Z22_ + Z21_ - Z6_ + Z12_ + Z9_
         Z6_=Z6_*Z15_
         Z9_=p1p4*Z16_
         Z8_= - p1p3*Z8_
         Z8_=Z8_ + Z19_ + Z9_
         Z4_=Z8_*Z4_
         Z8_= - p1p3*Z18_
         Z9_= - p1p4 - mm2
         Z9_=p2p3*Z9_
         Z4_=Z4_ + Z6_ + Z9_ + Z8_ + Z3_ - Z20_
         Z4_=dp1km1*Z4_
         Z6_= - Z17_ - Z14_ + Z13_
         Z6_=p1p2*Z6_
         Z8_= - p1p2*Z10_
         Z8_= - Z23_ + Z8_
         Z8_=me2*Z8_
         Z6_=Z8_ + Z21_ + Z6_
         Z8_=p1p22*p3p4
         Z6_= - 4*Z8_ + 2*Z6_
         Z6_=dp1km1*Z6_
         Z5_= - p3k - Z5_ - p2p3 + p3p4 - p1k
         Z5_=Z5_*me2
         Z8_= - p2p4*p1p2
         Z9_= - p1p4 - p2p4
         Z9_=p2p3*Z9_
         Z6_= - Z5_ + Z9_ + Z3_ + Z8_ + Z6_
         Z6_=dp2km1*Z6_
         Z8_=p1p4 + p3p4
         Z8_=p2p4*Z8_
         Z3_= - Z5_ + Z7_ - Z3_ + Z8_
         Z3_=dp4km1*Z3_
         Z2_=Z2_ + Z6_ + Z4_ - p2p3 - p3p4 - Z18_ + Z3_
         Z2_=64*Z2_
         
         somma=t24m2*Z1_ + t13m2*Z11_ + t13m1*t24m1*Z2_
         
         ce2 = t13m2*Z11_ / somma
         cm2 = t24m2*Z1_  / somma
         cem = t13m1*t24m1*Z2_ /somma      
      else  ! if Qmu > 0
         Z1_=dp3km2 + dp1km2
         Z2_=mm2*Z1_
         Z3_=dp1km1*mm2
         Z4_= - 1 + 4*Z3_
         Z5_=dp3km1*Z4_
         Z2_=Z5_ + dp1km1 + Z2_
         Z2_=p1p3*Z2_
         Z1_=Z1_*mm4
         Z5_=dp3km1*mm2
         Z6_=2*mm2
         Z7_=Z6_*dp1km2
         Z8_=Z7_ + dp1km1
         Z9_= - p3k*Z8_
         Z10_=Z6_*dp3km2
         Z11_=Z10_ - dp3km1
         Z12_=p1k*Z11_
         Z13_=4*dp3km1
         Z14_= - p1p32*dp1km1*Z13_
         Z2_= - 4*Z1_ + Z14_ + Z12_ + 2*Z2_ - Z5_ + Z3_ + Z9_
         Z2_=me2*Z2_
         Z9_=4*dp1km1
         Z12_=p1p3*dp3km1
         Z14_=Z9_*Z12_
         Z15_=dp3km1 - dp1km1
         Z7_= - Z14_ - Z15_ + Z7_ + Z10_
         Z10_= - p2p3*Z7_
         Z14_=2*dp1km1
         Z16_= - p1p2*Z14_
         Z10_=Z10_ + Z16_
         Z10_=p1p4*Z10_
         Z7_= - p1p2*Z7_
         Z16_=2*dp3km1
         Z17_=Z16_*p2p3
         Z7_=Z17_ + Z7_
         Z7_=p3p4*Z7_
         Z18_=Z14_*Z12_
         Z11_=Z11_ - Z18_
         Z19_= - p1p4*Z11_
         Z8_=Z8_ - Z18_
         Z18_=p3p4*Z8_
         Z20_= - p4k*Z3_*Z13_
         Z18_=Z20_ + Z19_ + Z18_
         Z18_=p2k*Z18_
         Z8_=p2p3*Z8_
         Z11_= - p1p2*Z11_
         Z8_=Z8_ + Z11_
         Z8_=p4k*Z8_
         Z11_=Z3_*Z12_
         Z1_= - 2*Z11_ + Z1_
         Z11_=2*p2p4
         Z1_=Z1_*Z11_
         Z1_=Z1_ + Z18_ + Z2_ + Z8_ + Z10_ + Z7_
         Z1_=64*Z1_
         Z2_= - me2*p1k*p3k
         Z7_= - p2p42*mm2
         Z2_=Z2_ + Z7_
         Z2_=dp4km1*Z2_
         Z7_=p4k*mm2
         Z8_=me2*mm2
         Z10_=2*p1p2
         Z18_= - p2p3*Z10_
         Z19_=p3k - p2p3
         Z19_=p1p4*Z19_
         Z20_=p1k - p1p2
         Z20_=p3p4*Z20_
         Z2_=4*Z2_ + Z8_ - Z7_ + Z20_ + Z18_ + Z19_
         Z2_=dp2km1*Z2_
         Z7_=p1p2*p3k
         Z18_=p1k*p2p3
         Z19_=Z7_ + Z18_
         Z20_=p1p4*p2p3
         Z21_=p1p2 + 2*p1p4
         Z21_=p3p4*Z21_
         Z22_= - p2k*mm2
         Z20_=Z22_ - Z8_ + Z21_ + Z20_ + Z19_
         Z20_=dp4km1*Z20_
         Z21_= - dp4km2*Z19_
         Z22_=p3k*dp2km2
         Z23_=dp4km2 + dp2km2
         Z24_= - p2p3*Z23_
         Z22_=Z22_ + Z24_
         Z22_=p1p4*Z22_
         Z24_=p1k*dp2km2
         Z25_= - p1p2*Z23_
         Z24_=Z24_ + Z25_
         Z24_=p3p4*Z24_
         Z25_=dp2km2*mm2
         Z26_= - p4k*Z25_
         Z21_=Z26_ + Z24_ + Z22_ + Z21_
         Z21_=me2*Z21_
         Z22_=dp4km2*mm2
         Z22_=Z22_ + Z25_
         Z23_=p1p3*Z23_
         Z23_= - 2*Z22_ + Z23_
         Z23_=me4*Z23_
         Z8_=p2k*dp4km2*Z8_
         Z8_=Z8_ + Z21_ + Z23_
         Z21_= - p3k + 2*p2p3
         Z21_=p1p4*Z21_
         Z23_= - p1k + Z10_
         Z23_=p3p4*Z23_
         Z6_=Z6_ - p1p3
         Z6_=me2*Z6_
         Z6_=2*Z6_ + Z23_ + Z21_ + Z19_
         Z6_=dp4km1*Z6_
         Z6_=mm2 + Z6_
         Z6_=dp2km1*Z6_
         Z19_=me2*Z22_
         Z21_= - dp4km1*mm2
         Z6_=Z6_ + Z19_ + Z21_
         Z6_=Z6_*Z11_
         Z2_=Z6_ + Z2_ + 2*Z8_ + Z20_
         Z2_=64*Z2_
         Z6_=Z16_*Z18_
         Z8_=p2p3*dp3km1
         Z11_= - p1p2*dp1km1
         Z8_=Z8_ + Z11_
         Z8_=p1p4*Z8_
         Z6_=4*Z8_ + Z6_ + p1p2
         Z6_=p3p4*Z6_
         Z8_=Z14_*p3k
         Z11_=p1p3*dp1km1
         Z8_= - Z8_ - 8*Z3_ + 1 + 4*Z11_
         Z19_=p1p4*Z8_
         Z20_= - 4*Z12_ + 1 + 8*Z5_
         Z16_= - p1k*Z16_
         Z16_=Z16_ + Z20_
         Z16_=p3p4*Z16_
         Z16_=Z16_ + Z19_ - p1p2 - p1k - p3k - p2p3
         Z16_=me2*Z16_
         Z7_= - Z14_*Z7_
         Z7_= - p2p3 + Z7_
         Z7_=p1p4*Z7_
         Z19_=dp3km1 + dp1km1
         Z21_=p1p4*Z19_
         Z21_= - Z5_ + Z21_
         Z21_=p3p4*Z21_
         Z22_=p1p4*Z3_
         Z21_=Z22_ + Z21_
         Z21_=p2k*Z21_
         Z9_= - p1p42*p2p3*Z9_
         Z22_=p3p42*p1p2*Z13_
         Z6_=2*Z21_ + Z16_ + Z22_ + Z9_ + Z7_ + Z6_
         Z6_=dp4km1*Z6_
         Z7_= - p1p2*Z8_
         Z8_= - p2p3*Z20_
         Z9_= - 1 + Z17_
         Z9_=p1k*Z9_
         Z7_=p3p4 + p1p4 + Z7_ + Z9_ - p3k + Z8_
         Z7_=me2*Z7_
         Z8_= - p3k*dp1km1
         Z9_=p2p3*Z14_
         Z8_=Z8_ + Z9_
         Z8_=Z8_*Z10_
         Z9_= - p2p32*Z13_
         Z8_=Z8_ + Z9_ + p2p3
         Z8_=p1p4*Z8_
         Z9_=p1p22*Z14_
         Z10_=dp3km1*Z18_
         Z9_=Z9_ + Z10_
         Z10_= - p2p3*Z13_
         Z10_= - 1 + Z10_
         Z10_=p1p2*Z10_
         Z9_=2*Z9_ + Z10_
         Z9_=p3p4*Z9_
         Z10_= - p2p3*Z19_
         Z10_=Z3_ + Z10_
         Z10_=p1p2*Z10_
         Z13_= - p2p3*Z5_
         Z10_=Z13_ + Z10_
         Z10_=p4k*Z10_
         Z7_=Z7_ + 2*Z10_ + Z8_ + Z9_
         Z7_=dp2km1*Z7_
         Z8_=p1p4*Z4_
         Z9_=1 + 4*Z5_
         Z10_= - p3p4*Z9_
         Z8_=Z8_ + Z10_
         Z8_=dp4km1*Z8_
         Z9_=p2p3*Z9_
         Z4_= - p1p2*Z4_
         Z4_=Z9_ + Z4_
         Z4_=dp2km1*Z4_
         Z4_=Z8_ + Z4_
         Z4_=p2p4*Z4_
         Z3_=Z5_ + Z3_
         Z5_= - p2k - p4k
         Z5_=Z3_*Z5_
         Z8_= - Z12_ + Z3_ + 1
         Z9_=p2p3*Z8_
         Z3_= - Z11_ + Z3_ - 1
         Z10_= - p1p2*Z3_
         Z11_= - p2p3*Z15_
         Z3_=Z11_ - Z3_
         Z3_=p1p4*Z3_
         Z11_=p1p2*Z15_
         Z8_=Z11_ + Z8_
         Z8_=p3p4*Z8_
         Z3_=Z4_ + Z7_ + Z6_ + Z8_ + Z3_ + Z9_ + Z10_ + Z5_
         Z3_=64*Z3_

         somma=t24m2*Z1_ + t13m2*Z2_ + t13m1*t24m1*Z3_
         
         ce2 = t13m2*Z2_ / somma
         cm2 = t24m2*Z1_ / somma
         cem = t13m1*t24m1*Z3_ /somma      
      endif
      return
      end
****************************************************
      function dot(p,q)
      implicit double precision (a-h,o-z)
      double precision p(0:3),q(0:3)
      dot=p(0)*q(0)-p(1)*q(1)-p(2)*q(2)-p(3)*q(3)
      return
      end
